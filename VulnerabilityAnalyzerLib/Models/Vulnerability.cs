using System.Collections.Generic;
using System.Linq;

namespace VulnerabilityAnalyzerLib.Models
{
    public abstract class Vulnerability
    {
        public string Name { get; protected set; }
        public List<Pattern> Patterns { get; protected set; }

        public List<SourceLine> ApplyPatterns(SourceText sourceText)
        {
            var foundLines = new List<SourceLine>();
            foreach (var pattern in Patterns)
            {
                var foundLinesForSomePattern = pattern(sourceText);
                foundLinesForSomePattern = foundLinesForSomePattern.Distinct().ToList();
                // TODO: Need insert the same lines only one time
                foundLines.AddRange(foundLinesForSomePattern);
            }
            return foundLines;
        }
    }
}
